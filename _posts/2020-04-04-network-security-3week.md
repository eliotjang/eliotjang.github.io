---
title: "[네트워크보안] Chapter 02. 암호학"
excerpt: "장상수 저, 정보보호총론, 생능출판, 2015"

categories:
  - network security
tags:
  - network security
last_modified_at: 2020-04-04T17:00:00+09:00
---  

## 2.1 암호의 개념  

1. **암호의 역사**
    1. 고대 암호
	- BC 400~500년경 고대 그리스의 군사들은 스키테일(scytale) 암호라고 불리는 전치암호(Transposition Cipher, 문자의 위치를 서로 바꾸는 암호)를 사용한 기록이 있다.  
	![](https://eliotjang.github.io/assets/images/network-security/ch02-1.png){: width="168" hegith="99"}  
	- BC 50년경 시저 암호 (치환암호 - substitution cipher)  
	![](https://eliotjang.github.io/assets/images/network-security/ch02-2.png){: width="470" hegith="138"}  
    2. 근대 암호
	- 근대 암호의 이론적 기초가 된 논문은 1920년 프리드먼(Freidman)이 발표한 『일치 반복률과 암호 응용』과 1949년 섀넌(Shannon)이 발표한 『비밀 시스템의 통신이론』을 들 수 있다.
	- 2차대전 중 Enigma 암호  
	![](https://eliotjang.github.io/assets/images/network-security/ch02-3.png){: width="180" hegith="217"}
	- 코드북 암호  
	![](https://eliotjang.github.io/assets/images/network-security/ch02-4.png){: width="417" hegith="154"}  
    3. 현대 암호
	- 1976년 스탠퍼드 대학의 디피(Diffie)와 헬만(Hellman)은 『암호의 새로운 방향』(Directions in Cryptography)이라는 논문에서 처음으로 공개키 암호의 개념을 발표
	- 이어 1978년 메사추세스 공과대학(MIT)의 리베스트(Rivest), 샤미르(Shamir), 아델먼(Adelman)이 소인수 분해 문제에 기반을 둔 RSA 공개키 암호를 개발
	- DES(Data Encryption Standard)는 1977년에 미국의 연방 정보처리 표준 규격(FIPS)으로 채택된 대칭 암호
	- AES(Advanced Encryption Standard) - DES를 대신한 새로운 표준 대칭 암호 알고리즘  

2. **암호 시스템**
    1. 암호 기술
	- 암호 기술은 평문을 해독 불가능한 형태로 변형하거나 또는 생성된 암호문으로부터 해독 가능한 형태로 변환하기 위한 원리, 수단, 방법 등을 취급하는 기술로 공개된 네트워크에서 불법적인 도청을 방지하기 위하여 사용한다.
	- 암호 기술은 사용하는 키의 종류에 따라 암호화키와 복호화키가 같은 대칭키 암호 알고리즘과 암호화키가 복호화키가 다른 공개키 암호 알고리즘으로 구분되며, 대칭키 암호 알고리즘은 변환하는 방법에 따라 블록 암호 알고리즘과 스트림 암호 알고리즘으로 구분된다.  
    2. 암호 시스템 구성 요소
	- 암호화하고 복호화하는 일련의 과정에 필요한 요소를 모두 합쳐서 암호 시스템이라고 한다. 암호 시스템의 구성요소로는 평문(plaintext), 암호문(Ciphertext), 암호화(복호화) 알고리즘(encryption/decryption algorithm), 키(key)로 구성된다.  
	- 암호 시스템은 일반적으로 다음과 같은 세 가지의 요건을 충족시켜야 한다.  
	① 암호화키에 의하여 암호화 및 복호화가 효과적으로 이루어져야 한다.  
	② 암호 시스템은 사용이 용이하여야 한다.  
	③ 암호화 알고리즘 자체보다는 암호 키에 의한 보안이 이루어져야 한다.  
	![](https://eliotjang.github.io/assets/images/network-security/ch02-5.png){: width="454" hegith="127"}  
    3. 암호 기술의 미래 양자 암호(Quantum Cryptography)
	- 양자 암호는 안전한 통신을 위한 암호체계이다. 1984년 베넷(C. H. Benett)과 브라사드(G. Brassard)가 제안하였으며 기존에 있던 대부분의 암호체계가 수학적 복잡성에 기반을 두는데 비해, 양자 암호는 양자역학적 성질을 이용하여 암호에 사용되는 원 타임 패드를 생성하는 이상적인 방법 중 하나이다.	
	- 양자 암호통신의 구성
	    1. 양자채널을 이용하여 안전하게 키를 분배하고
	    2. 일반 통신망을 통해 키를 이용하여 안전한 암호통신을 수행한다.  
	    ![](https://eliotjang.github.io/assets/images/network-security/ch02-6.png){: width="338" hegith="190"}  

3. **암호 알고리즘**
    - 암호화와 복호화 알고리즘
    - 대칭키 암호 알고리즘(블록 암호와 스트림 암호)  

    |구분|블록 암호|스트림 암호|
    |----|-----------------------|-------------------------------------------|
    |방식|블록이라 부르는 고정된 길이의 자료를 단위로 암호화하는 방식|평문과 같은 길이의 키 스트림을 생성하여 평문과 키 이진수열을 비트단위로 배타적 논리합(bitwise exclusive OR) 이진연산으로 결합하여 암호문 생성.<br/>한 비트씩 암호화 및 복호화 하는 방식|
    |장점|구현이 쉽다|오류확산의 위험이 없다.<br/>이동 통신 환경에서 구현이 용이|
    |단점|블록내의 오류 확산 위험이 있다.<br/>필요하지 않은 초기 값을 설정.|시간이 많이 걸린다.|  

4. **암호 프로토콜**
    1. 암호 프로토콜
	- 정보통신 환경에서 인증 및 무결성 문제를 해결하기 위한 보안 프로토콜
	- 기본 암호 프로토콜(개인 식별 및 인증, 전자서명 등)과 발전된 암호 프로토콜(전자화폐, 전자결제, 전자선거 등)로 분류할 수 있다.
    2. 암호 프로토콜에 대한 공격
	- 수동적 공격  
	①메시지 도청: 전송되는 메시지를 도중에 가로챔  
	②트래픽 분석: 암호화된 메시지 내용 파악을 못하더라도 송수신 측 신원 파악 가능  
	- 능동적 공격  
	①메시지 변조: 전송되는 메시지들의 순서를 바꾸거나 일부분을 다른 메시지로 대체  
	②삽입 공격: 공격자가 정당한 송신자로 가장하여 특정 수신자에게 메시지를 전송  
	③삭제 공격: 정상적인 통신시설의 사용과 권리를 방해하는 DoS 공격으로 특정 수신자에게 전송하는 메시지의 전부 또는 일부를 삭제  
	④재전송 공격(replay): 공격자가 이전에 특정 송신자와 수신자간에 행해졌던 통화내용을 도청하여 보관하고 있다가 나중에 재생하여 전송  
    3. 암호알고리즘에 대한 공격
	- 공격의 종류  
	①암호문 단독 공격(Ciphertext only attack): 암호 해독자는 단지 암호문 C만을 갖고 이로부터 P이나 키 K를 찾아내는 방법으로 평문 P의 통계적 성질, 문장의 특성 등을 추정하여 해독하는 방법이다.  
	②기지 평문 공격(Known plaintext attack): 암호 해독자는 일정량의 평문 P에 대응하는 암호문 C를 알고 있는 상태에서 해독하는 방법으로 암호문 C와 평문 P의 관계로부터 키 K나 평문 P를 추정하여 해하는 방법이다.  
	③선택 평문 공격(Chosen plaintext attack): 암호 해독자가 사용된 암호기에 접근할 수 있어 평문 P를 선택하여 그 평문 P에 해당하는 암호문 C를 얻어 키 K나 평문 P를 추정하여 암호를 해독하는 방법이다.  
	④선택 암호문 공격(Chosen Ciphertext attack): 암호 해독자가 암호 복호기에 접근할 수 있어 암호문 C에 대한 평문 P를 얻어내 암호를 해독하는 방법이다.  

5. **키 관리**
    1. 개요
	- 아무리 견고한 암호 시스템이라 할지라도 만약 키 관리가 소홀하다면 그 암호 시스템은 무용지물이 될 수 있다.
	- 키 관리의 목적은 대칭키 암호 시스템 또는 공개키 암호 시스템에서 사용되는 암호학적 키들을 안전하게 다루기 위해 키의 생성, 등록, 확인, 분배, 설치, 저장, 파생, 보관, 취소, 말소, 폐기 등과 같은 일련의 절차를 제공하는 것이다.  
    2. 대칭키와 공개키 비교
	- 대칭키는 암호화할 때와 복호화할 때의 키가 같은 것을 의미한다. 이때의 대칭키는 비밀키(secret key)와 같은 것을 말한다.
	- 비밀키라는 용어를 사용하는 암호화할 때와 복호화할 때 사용되는 키가 같기 때문에 암호문이 암호문으로서 효과를 가지기 위해서는 발신자와 수신자 사이의 키에 대한 정보가 비밀로 유지되어야 하기 때문이다.
	- 반면에 암호화할 때와 복호화할 때의 키가 다른 것은 비대칭키(공개키)라고 한다.  
    - 대팅키 암호시스템과 공개키 암호시스템의 비교  

    |구분|대칭키 암호 시스템|공개키 암호 시스템|
    |----------|-----------------------|----------------------|
    |키의 상호관계|암호화키=복호화키|암호화키≠복호화키|
    |암호화키|비밀키|공개키|
    |복호화키|비밀키|개인키|
    |대표적인 예|DES/AES|RSA|
    |비밀키 전송|필요|불필요|
    |키 개수|n(n-1)/2|2n|
    |안전한 인증|어려움|쉬움|
    |암호화 속도|고속|저속|
    |경제성|높음|낮음|
    |전자서명|복잡|간단|
    |장점|암호화/복호화 속도가 빠름.<br/>키 길이가 짧음|키의 분배가 용이함.<br/>사용자의 증가에 따라 관리할 키의 개수가 상대적으로 적음.<br/>여러 가지 분야에서 응용이 가능함|
    |단점|사용자의 증가에 따라 관리해야 할 키의 수가 상대적으로 많음.<br/>키 변화의 빈도가 높음|암호화/복호화 속도가 느림.<br/>키의 길이가 김|  



## 2.2 대칭키 암호 시스템(Symmetric-key cryptosystem)  

1. **대칭키 암호 방식 특징**
    - 대칭키 암호(Symmetric-key cryptosystem) 방식에서는 암호화에 사용되는 암호화키와 복호화에 사용되는 복호화키가 동일하다는 특징이 있으며, 이 키를 송신자와 수신자 이외에는 노출되지 않도록 비밀히 관리해야 한다.
    - 우리가 일반적으로 사용하는 암호라는 의미로 '관용 암호'라고도 하며 키를 비밀히 보관해야 한다는 의미로 '비밀키 암호(Secret-key cryptosystem)'라고도 한다.
    - 대칭키 암호는 암호화 연산 속도가 빨라서 효율적인 암호 시스템을 구축할 수 있다.
    - 비밀키(대칭키) 암호시스템의 특징은  
    ①오랜 역사를 지니고 있어 기존의 정보기술과 상호운용이 쉽다.  
    ②데이터 처리량이 크다.  
    ③암호화키의 크기가 공개키 암호시스템보다 상대적으로 작다.  
    ④알고리즘 내부 구조가 간단하여 시스템 환경에 적절한 암호 알고리즘 개발이 용이하다.  
    ⑤정보교환 당사자 간에 동일한 키를 공유해야 하므로 키 관리가 어렵다.  

2. **블록 암호(Block Cipher) 알고리즘**
    1. 개념
	- 암호문을 만들기 위해 평문을 일정한 단위로 나누어서 각 단위마다 암호화 과정을 수행하여 블록단위로 암호문을 얻는 대칭 암호화 방식이다.
	- 각 블록의 연산에는 동일한 키가 이용된다.  
	![](https://eliotjang.github.io/assets/images/network-security/ch02-7.png){: width="428" hegith="216"}  
    2. 블록 암호 알고리즘 구조
	- 블록 암호의 이론적 토대는 전치와 치환을 반복함으로써 평문과 암호문으로부터 키에 대한 정보를 이끌어 내기 어렵게 하는 것  
	    1. 페이스텔 구조
		- 3라운드 이상이며, 짝수 라운드로 구성된다. 이러한 구조는 라운드 함수와 관계없이 역변환이 가능하며(즉, 암·복호화 과정이 같은), 두 번의 수행으로 블록간의 완전한 확산이 이루어지며 알고리즘의 수행속도가 빠르고, 하드웨어 및 소프트웨어 구현이 용이하고, 아직 구조상에 문제점이 발견되고 있지 않다는 장점을 지니고 있다. 대표적 암호로 DES가 있다.  
		![](https://eliotjang.github.io/assets/images/network-security/ch02-8.png){: width="275" hegith="348"}  
	    2. SPN (Substitution Permutation Network) 구조
		- 치환과 순열을 반복적으로 사용하는 구조
		- 암호화 함수와 복호화 함수가 다름
		- 하드웨어나 소프트웨어 구현시 페이스텔 구조보다 비용이 큼
		- 대표적 암호로 AES가 있음
	    3. 블록 암호 요소의 특징
		- 블록 암호 알고리즘을 특징하는 요소로는 다음과 같은 것이 있으며, 이러한 요소에 의해 전체 블록 암호의 안전성이 결정된다.  
		①블록 크기: 입출력 블록의 비트수로, 일반적으로 더 클수록 안전하다고 보지만, 암·복호화 과정에서 시간이 더 걸린다. 주로 64비트가 널리 쓰였지만, 최근에는 128비트를 채택하고 있다.  
		②키 크기: 비밀키의 비트수로, 일반적으로 더 클수록 이 역시 라운드키를 생성할 때 시간이 더 걸린다.  
		③라운드키 생성: 비밀키로부터 각 라운드에 사용할 키를 생성하는 과정으로, 유사시에 라운드키가 누출되더라도 비밀키는 안전해야 한다.  
		④라운드 함수: 암·복호화를 수행하는 핵심함수로 다양한 암호분석을 거쳐 안전하게 만들어져야 한다.  
		⑤라운드 수: 한 번의 암·복호화를 위해 반복하는 라운드 함수의 횟수로, 많을수록 더 안전하다고 보지만 암·복호화 과정에서 시간이 더 걸린다.  
		- 근본적으로 한 번의 라운드 함수로 충분한 안전성을 확보할 수는 없기에 라운드 함수에 대한 다양한 암호분석을 통해 충분한 안전성을 얻을 수 있도록 라운드 횟수를 결정한다.  
	    4. 블록 암호 알고리즘 종류  
		**➊ 데이터 암호 표준(DES, Data Encryption Standard)**  
		     › DES는 대칭키 암호 중 하나인 64비트 블록 암호이며 56비트 비밀키를 사용한다. 1977년에 미국 NBS(National Bureau of Standards, 현 NIST)에서 이 알고리즘을 미국 표준 블록 암호 알고리즘으로 채택하였다.  
		**➋ 트리플 데이터 암호 표준(Triple DES)**  
		     › DES에 대한 전수공격으로 인해 더 이상 안전하지 않다는 것이 증명되어 DES를 보완하기 위해 고안된 알고리즘이 Triple DES이다.  
		     › Triple DES는 3개의 키 값을 사용하고 DES 16라운드의 3배에 해당하는 48라운드를 수행하여 암호화 강도를 높였다.  
		    ![](https://eliotjang.github.io/assets/images/network-security/ch02-9.png){: width="413" hegith="153"}  
		**➌ 고급 암호화 표준(AES, Advanced Encryption Standard)**  
		    › AES는 미국 표준 블록 암호였던 DES의 안전성에 문제가 제기됨에 따라 2000년 새로운 미국 표준 블록 암호로 채택된 128-비트 블록 암호이다.  
		    › AES의 암호화 과정은 DES와 달리 SPN 구조 채택  
		    › 키의 비트 길이 - 128, 192, 256비트 길이  
		**➍ 국제 데이터 암호화 알고리즘(IDEA, International Data Encryption Algorithm)**  
		    › 스위스에서 1992년 세지아 레이(Xuejia Lai), 제임스 메시(James Messey)에 의해 제안된 처리 속도가 빠름  
		    › IDEA는 128비트 키, 8라운드, 64비트 블록  
		    › RSA와 더불어 PGP에 사용되는 방식  
		**➎ 아리아(ARIA)**  
		    › 아리아(ARIA)는 우리나라의 국가보안기술연구소에서 개발한 블록 암호 체계이다. ARIA라는 이름은 학계(Academy), 연구소(Research Institute), 정부 기관(Agency)이 공동으로 개발한 특징을 함축적으로 표현한 것이다.  
		    › 2004년 산업자원부의 KS 인증(KS X 1213:2004)을 획득하여 현재까지 우리나라의 국가 표준 암호 알고리즘으로 2010년 웹 표준 중 하나가 되었다.  
		**➏ 시드(SEED)**  
		    › 시드(SEED)는 전자 상거래, 금융, 무선 통신 등에서 전송되는 개인정보와 같은 중요한 정보를 보호하기 위해 1999년 2월 한국정보보호진흥원(KISA)과 국내 암호 전문가들이 순수 국내 기술로 개발한 128-비트 블록 암호이다.  
		    › SEED128은 1999년 9월 정보통신단체표준(TTA)으로 제정되었으며, 2005년에는 국제 표준화 기구인 ISO/IEC에서 국제 블록 암호 표준으로 제정하였으며, IETF에서도 표준으로 제정되었다.  
		**➐ 하이트(HIGHT, HIGh security and light weigHT)**  
		    › HIGHT는 RFID, USN 등과 같이 저전력·경량화를 요구하는 컴퓨팅 환경에서 기밀성을 제공하기 위해 2005년 KISA, ETRI 부설 연구소 및 고려대가 공동으로 개발한 64-비트 블록 암호이다.  
		    › 이 알고리즘은 2006년 12월 정보통신단체표준(TTA)으로 제정되었으며, 2010년 ISO/IEC 국제 블록 암호 표준으로 제정되었다.  
		**➑ LEA(Lightweight Encryption Algorithm)**  
		    › 2012년 국가보안기술연구소가 개발한 '128비트 경량 고속 블록 암호 알고리즘'  
		    › LEA는 현재 가장 많이 쓰이는 미국 연방 표준 알고리즘 AES(Advanced Encryption Standard)보다 1.5~2배 빠르다. 다양한 정보보호 서비스에서 대용량 데이터를 빠르게 처리하거나 스마트폰 보안, 사물인터넷(IoT) 등 저전력 암호화에 널리 쓸 수 있다.  
		**➒ 블로피시(Blowfish)**  
		    › 1993년 브루스 슈나이어가 설계한 개발한 대칭키 암호 알고리즘으로 가변적인 키 길이(32~448비트)를 가지며, 구현이 간단하고 알고리즘의 안전성을 분석하기 쉬우며,  
		    › 키의 크기가 가변적이므로 안전성과 성능의 요구에 따라 유연하게 사용이 가능하다.  
	    5. 블록 암호 모드
		- 긴 평문을 암호화하기 위해서는 블록 암호 알고리즘을 반복해서 사용하여 긴 평문 전부를 암호화할 필요가 있다. 이처럼 반복하는 방법을 블록 암호의 모드(mode)라고 함  
		① ECB 모드: Electronic CodeBook mode  
		- 간단, 고속, 병렬처리가 가능하나 암호문 블록의 삭제나 교체에 의한 평문의 조작이 가능하고 재전송 공격이 가능하여 사용을 하지 않는다.  
		![](https://eliotjang.github.io/assets/images/network-security/ch02-10.png){: width="582" hegith="254"}  
		② CBC 모드: Cipher Block Chaining mode(암호 블록연쇄 모드)  
		- 평문의 반복은 암호문에 반영되지 않고 임의의 암호문 블록을 복호화 할 수 있으나, 비트 단위의 에러가 있는 암호문을 복호화하면 1블록 전체와 다음 블록의 대응하는 비트가 에러가 되는 단점이 있다. SSL/TLC 등 보안프로토콜에 많이 사용된다.  
		  ![](https://eliotjang.github.io/assets/images/network-security/ch02-11.png){: width="625" hegith="283"}  
		③ CFB 모드: Cipher-FeedBack mode(암호 피드백 모드)  
		- 패딩이 필요없고 복호화는 병렬 처리가 가능. 재전송 공격이 가능하다. 현재는 사용을 하지 않는다.  
		![](https://eliotjang.github.io/assets/images/network-security/ch02-12.png){: width="415" hegith="325"}  
		④ OFB 모드: Output-Feed Back mode(출력 피드백 모드)  
		- 패딩이 필요없고 암호화/복호화의 사전 준비를 할 수 있으나, 병렬처리가 불가하고 적극적 공격자가 암호문 블록을 비트 반전시키면 대응하는 평문 블록이 비트 반전된다. CTR 모드를 사용하는 편이 낫다.  
		![](https://eliotjang.github.io/assets/images/network-security/ch02-13.png){: width="637" hegith="319"}  
		⑤ CTR 모드: CounTeR mode(카운터 모드)  
		- 패딩이 필요없고 암호화/복호화의 사전준비를 할 수 있으며 병렬처리가 가능하나, 적극적 공격자가 암호 블록을 비트 반전시키면 대응하는 평문 블록이 비트 반전된다.  
		![](https://eliotjang.github.io/assets/images/network-security/ch02-14.png){: width="622" hegith="298"}  
	    6. 블록 암호 공격 기법  
	    |공격 기법|개념|
	    |-------------|------------|
	    |차분공격<br/>(Differential Cryptanalysis)|1990년 비함(Biham)과 샤미르(Shamir)에 의하여 개발된 선택된 평문공격법으로, 두 개의 평문 블록들의 비트의 차이에 대하여 대응되는 암호문 블록들의 비트의 차이를 이용하여 사용된 암호열쇠를 찾아내는 방법이다.|
	    |선형공격<br/>(Linear Cryptanalysis)|1993년 마쓰이 미쓰루에 의해 개발되어 알려진 평문 공격법으로, 알고리즘 내부의 비선형 구조를 적당히 선형화시켜 열쇠를 찾는 방법이다.|
	    |전수공격법<br/>(Exhaustive key search)|1977년 디피(Diffie)와 헬만(Hellman)이 제안한 방법으로 암호화할 때 일어날 수 있는 모든 가능한 경우에 대하여 조사하는 방법으로 경우의 수가 적을 때는 가장 정확한 방법이지만, 일반적으로 경우의 수가 많은 경우에는 구현 불가능한 방법이다.|
	    |통계적 분석<br/>(Statistical analysis)|암호문에 대한 평문의 각 단어의 빈도에 관한 자료를 포함하는 지금까지 알려진 모든 통계적인 자료를 이용하여 해독하는 방법이다.|
	    |수학적 분석<br/>(Mathematical analysis)|통계적인 방법을 포함하며 수학적 이론을 이용하여 해독하는 방법이다.|  
**3. 스트림 암호(Stream Cipher) 알고리즘**
    - 스트림 암호는 블록 단위로 암·복호화되는 블록 암호와는 달리 이진화된 평문 스트림과 이진 키스트림 수열의 XOR 연산으로 암호문을 생성하는 방식
    - GSM의 통신 암호화에 사용됨 (A5/1)
    - 대표적 스트림 - RC4  
    ![](https://eliotjang.github.io/assets/images/network-security/ch02-15.png){: width="528" hegith="197"}  


## 2.3 공개키 암호 시스템(Public-key cryptosystem)  

대칭 암호
    - 「암호화 키」와 「복호화 키」 동일  

공개 키 암호
    - 「암호화 키」와 「복호화 키」 다르다
    - 「암호화 키」를 가지고 있는 사람이라면 누구든지 암호화 할 수 있음
    - 하지만 「암호화 키」를 가지고 있어도 복호화할 수는 없다
    - 복호화할 수 있는 것은 「복호화 키」를 가지고 있는 사람 뿐임
    - 암호화 키 → 공개키, 복호화 키 → 개인키
    - 대칭 암호에 비해 처리 속도가 매우 느림
    - 응용: 디지털 서명, 키 교환 등  

![](https://eliotjang.github.io/assets/images/network-security/ch02-16.png){: width="413" hegith="316"}  



## 2.4 해시 함수(Hash Function)  



## 2.5 메시지 인증  





## 2.6 PKI 및 전자서명(Digital signature)  



































